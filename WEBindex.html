<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Form Electricity, CW, NG.</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f9fafb;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 6px;
      text-align: center;
      min-width: 80px;
    }
    th {
      background: #2563eb;
      color: white;
      position: sticky;
      top: 0;
    }
    td:first-child {
      background: #f1f5f9;
      font-weight: bold;
    }
    input {
      width: 70px;
      padding: 4px;
      border: 1px solid #ccc;
      border-radius: 4px;
      text-align: center;
    }
    button {
      margin: 10px 5px 0 0;
      padding: 10px 15px;
      border: none;
      background: #16a34a;
      color: white;
      border-radius: 8px;
      cursor: pointer;
    }
    button:hover {
      background: #15803d;
    }
    .btn-secondary {
      background: #2563eb;
    }
    .btn-secondary:hover {
      background: #1d4ed8;
    }
  </style>
</head>
<body>
  <h2>üìä Form Electricity, CW, NG.</h2>

  <table id="dataTable">
    <thead>
      <tr>
        <th>Day</th>
        <!-- ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô -->
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>

  <button onclick="saveData()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
  <button class="btn-secondary" onclick="downloadCSV()">‚¨áÔ∏è ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î CSV</button>
  <button class="btn-secondary" onclick="downloadJSON()">‚¨áÔ∏è ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î JSON</button>

  <script>
    const topics = [
      "mdb1","mdb2","mdb3","lp-of","lp-g","pac-of","lp-f1","p1","p2","p3",
      "lp-f2","pac-f2","c-1","c-2","c-3","g-1","spare","s-scrub","p-di",
      "anodizing-1","anodizing-2","wasteplant","pac-f1","a-1","p-compressure",
      "pac-f3","m1","buoy"
    ];

    const theadRow = document.querySelector("#dataTable thead tr");
    const tableBody = document.getElementById("tableBody");

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô
    topics.forEach(topic => {
      const th = document.createElement("th");
      th.textContent = topic;
      theadRow.appendChild(th);
    });

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (Day 1-30)
    for (let day = 1; day <= 30; day++) {
      const row = document.createElement("tr");
      let cells = `<td>Day ${day}</td>`;
      topics.forEach(topic => {
        const id = `${topic}-day${day}`;
        cells += `<td><input id="${id}" type="text"></td>`;
      });
      row.innerHTML = cells;
      tableBody.appendChild(row);
    }

    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
    window.onload = () => {
      const saved = JSON.parse(localStorage.getItem("dailyData")) || {};
      for (let topic of topics) {
        for (let day = 1; day <= 30; day++) {
          const id = `${topic}-day${day}`;
          if (saved[id]) document.getElementById(id).value = saved[id];
        }
      }
    };

    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á localStorage
    function saveData() {
      const data = {};
      for (let topic of topics) {
        for (let day = 1; day <= 30; day++) {
          const id = `${topic}-day${day}`;
          data[id] = document.getElementById(id).value;
        }
      }
      localStorage.setItem("dailyData", JSON.stringify(data));
      alert("‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß!");
    }

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå CSV
    function downloadCSV() {
      let csv = "Day," + topics.join(",") + "\n";
      for (let day = 1; day <= 30; day++) {
        let row = [`Day ${day}`];
        topics.forEach(topic => {
          const id = `${topic}-day${day}`;
          row.push(document.getElementById(id).value);
        });
        csv += row.join(",") + "\n";
      }
      const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "form_data.csv";
      link.click();
    }

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå JSON
    function downloadJSON() {
      const data = {};
      for (let day = 1; day <= 30; day++) {
        data[`Day ${day}`] = {};
        topics.forEach(topic => {
          const id = `${topic}-day${day}`;
          data[`Day ${day}`][topic] = document.getElementById(id).value;
        });
      }
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "form_data.json";
      link.click();
    }
  </script>
</body>
</html>
